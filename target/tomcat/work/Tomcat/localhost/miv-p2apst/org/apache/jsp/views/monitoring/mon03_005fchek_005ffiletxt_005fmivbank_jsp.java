/*
 * Generated by the Jasper component of Apache Tomcat
 * Version: Apache Tomcat/7.0.47
 * Generated at: 2025-12-02 08:53:35 UTC
 * Note: The last modified time of this file was set to
 *       the last modified time of the source file after
 *       generation to assist with modification tracking.
 */
package org.apache.jsp.views.monitoring;

import javax.servlet.*;
import javax.servlet.http.*;
import javax.servlet.jsp.*;

public final class mon03_005fchek_005ffiletxt_005fmivbank_jsp extends org.apache.jasper.runtime.HttpJspBase
    implements org.apache.jasper.runtime.JspSourceDependent {

  private static final javax.servlet.jsp.JspFactory _jspxFactory =
          javax.servlet.jsp.JspFactory.getDefaultFactory();

  private static java.util.Map<java.lang.String,java.lang.Long> _jspx_dependants;

  private javax.el.ExpressionFactory _el_expressionfactory;
  private org.apache.tomcat.InstanceManager _jsp_instancemanager;

  public java.util.Map<java.lang.String,java.lang.Long> getDependants() {
    return _jspx_dependants;
  }

  public void _jspInit() {
    _el_expressionfactory = _jspxFactory.getJspApplicationContext(getServletConfig().getServletContext()).getExpressionFactory();
    _jsp_instancemanager = org.apache.jasper.runtime.InstanceManagerFactory.getInstanceManager(getServletConfig());
  }

  public void _jspDestroy() {
  }

  public void _jspService(final javax.servlet.http.HttpServletRequest request, final javax.servlet.http.HttpServletResponse response)
        throws java.io.IOException, javax.servlet.ServletException {

    final javax.servlet.jsp.PageContext pageContext;
    javax.servlet.http.HttpSession session = null;
    final javax.servlet.ServletContext application;
    final javax.servlet.ServletConfig config;
    javax.servlet.jsp.JspWriter out = null;
    final java.lang.Object page = this;
    javax.servlet.jsp.JspWriter _jspx_out = null;
    javax.servlet.jsp.PageContext _jspx_page_context = null;


    try {
      response.setContentType("text/html;charset=UTF-8");
      pageContext = _jspxFactory.getPageContext(this, request, response,
      			null, true, 8192, true);
      _jspx_page_context = pageContext;
      application = pageContext.getServletContext();
      config = pageContext.getServletConfig();
      session = pageContext.getSession();
      out = pageContext.getOut();
      _jspx_out = out;

      out.write("\r\n");
      out.write("\r\n");
      out.write("<!-- üîπ FORM FILTER -->\r\n");
      out.write("<div class=\"flex justify-center\">\r\n");
      out.write("    <fieldset class=\"border border-gray-300 rounded p-5 mt-4 w-full md:w-[760px] mx-auto bg-white shadow text-left\">\r\n");
      out.write("        <legend class=\"text-sm font-bold px-3 text-left\">Upload File Lunas - Bank MIV (RCN)</legend>\r\n");
      out.write("\r\n");
      out.write("        <form id=\"form-monitoring\">\r\n");
      out.write("            <div class=\"flex justify-center\">\r\n");
      out.write("                <div class=\"grid grid-cols-12 gap-3 mb-2 w-full md:w-[900px]\">\r\n");
      out.write("\r\n");
      out.write("                    <!-- Bulan Laporan -->\r\n");
      out.write("                    <div class=\"col-span-12 md:col-span-4\">\r\n");
      out.write("                        <label for=\"bln_usulan\" class=\"block text-gray-700 mb-1 font-medium\">Bulan Laporan :</label>\r\n");
      out.write("                        <div class=\"flex border border-gray-300 rounded items-center\">\r\n");
      out.write("                            <input type=\"text\" id=\"bln_usulan\"\r\n");
      out.write("                                class=\"flex-1 px-3 py-2 text-sm uppercase focus:outline-none focus:ring-1 focus:ring-blue-500\"\r\n");
      out.write("                                placeholder=\"Pilih Bulan Laporan\" readonly>\r\n");
      out.write("                            <i id=\"calendarIcon\"\r\n");
      out.write("                                class=\"fa fa-calendar text-gray-500 px-3 cursor-pointer hover:text-blue-600\"></i>\r\n");
      out.write("                        </div>\r\n");
      out.write("                        <input type=\"hidden\" id=\"bln_usulan_value\" name=\"bln_usulan_value\">\r\n");
      out.write("                    </div>\r\n");
      out.write("\r\n");
      out.write("                    <!-- Bank MIV -->\r\n");
      out.write("                    <div class=\"col-span-12 md:col-span-4\">\r\n");
      out.write("                        <label for=\"bank_miv\" class=\"block text-gray-700 mb-1 font-medium\">Bank MIV :</label>\r\n");
      out.write("                        <select id=\"bank_miv\" name=\"bank_miv\"\r\n");
      out.write("                            class=\"w-full border border-gray-300 rounded px-3 py-2 text-sm focus:ring-1 focus:ring-blue-500\">\r\n");
      out.write("                            <option value=\"\">-- Pilih Bank MIV --</option>\r\n");
      out.write("                        </select>\r\n");
      out.write("                    </div>\r\n");
      out.write("\r\n");
      out.write("                    <!-- Chek File -->\r\n");
      out.write("                    <div class=\"col-span-12 md:col-span-4\">\r\n");
      out.write("                        <label for=\"idtxt_rcn\" class=\"block text-gray-700 mb-1 font-medium\">Chek File TXT/RCN :</label>\r\n");
      out.write("                        <select id=\"idtxt_rcn\" name=\"txt_rcn\"\r\n");
      out.write("                            class=\"w-full border border-gray-300 rounded px-3 py-2 text-sm focus:ring-1 focus:ring-blue-500\">\r\n");
      out.write("                            <option value=\"TXT\">File TXT Untuk Bank</option>\r\n");
      out.write("                            <option value=\"RCN\">File RCN Dari Bank</option>\r\n");
      out.write("                        </select>\r\n");
      out.write("                    </div>\r\n");
      out.write("\r\n");
      out.write("                </div>\r\n");
      out.write("            </div>\r\n");
      out.write("\r\n");
      out.write("            <!-- Row berikutnya: Find Id + Button Cari -->\r\n");
      out.write("            <div class=\"flex justify-center\">\r\n");
      out.write("                <div class=\"grid grid-cols-12 gap-3 mb-2 w-full md:w-[900px]\">\r\n");
      out.write("\r\n");
      out.write("                    <!-- Input ID lebih lebar -->\r\n");
      out.write("                    <div class=\"col-span-12 md:col-span-9\">\r\n");
      out.write("                        <label for=\"idtrans\" class=\"block text-gray-700 mb-1 font-semibold\">\r\n");
      out.write("                            Masukkan IdTransaksi / Nousulan :\r\n");
      out.write("                        </label>\r\n");
      out.write("\r\n");
      out.write("                        <div class=\"relative\">\r\n");
      out.write("                            <input type=\"text\" id=\"idtrans\"\r\n");
      out.write("                                class=\"w-full border border-gray-300 rounded px-3 py-2 text-sm pr-10\r\n");
      out.write("                                    focus:ring-1 focus:ring-blue-500\"\r\n");
      out.write("                                placeholder=\"Ketik IdTransaksi / Nousulan [ */'' = Semua; POS53DP / NTL53 / PRE53DPK = ID ]\">\r\n");
      out.write("\r\n");
      out.write("                            <!-- Ikon Search -->\r\n");
      out.write("                            <i class=\"fa fa-search absolute right-3 top-1/2 -translate-y-1/2 text-gray-500\"></i>\r\n");
      out.write("                        </div>\r\n");
      out.write("                    </div>\r\n");
      out.write("\r\n");
      out.write("                    <!-- Tombol Tampilkan (versi baru, tetapi mengikuti grid lama) -->\r\n");
      out.write("                    <div class=\"col-span-12 md:col-span-3 flex items-end justify-center\">\r\n");
      out.write("                        <button id=\"btnTampil\" type=\"button\"\r\n");
      out.write("                            class=\"max-w-[140px] w-full  bg-blue-600 hover:bg-blue-700 text-white font-semibold px-3 py-2 rounded shadow \r\n");
      out.write("                                flex items-center justify-center gap-2 transition duration-150 ease-in-out\">\r\n");
      out.write("                            <i class=\"fa fa-search\"></i> <span>Tampilkan</span>\r\n");
      out.write("                        </button>\r\n");
      out.write("                    </div>\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("                </div>\r\n");
      out.write("            </div>\r\n");
      out.write("\r\n");
      out.write("        </form>\r\n");
      out.write("    </fieldset>\r\n");
      out.write("</div>\r\n");
      out.write("\r\n");
      out.write("<!-- Wrapper utama 2 kolom simetris -->\r\n");
      out.write("<div class=\"grid grid-cols-1 md:grid-cols-2 gap-6 mt-4 w-full\">\r\n");
      out.write("\r\n");
      out.write("    <!-- KIRI - SUKSES -->\r\n");
      out.write("    <fieldset class=\"border border-gray-300 rounded p-5 text-center bg-white shadow w-full\">\r\n");
      out.write("        <h3 id=\"label_sukses\" class=\"text-xl font-semibold mb-4\">üìÇ Daftar File TXT dari AP2T</h3>\r\n");
      out.write("\r\n");
      out.write("        <div id=\"loading_sukses\" class=\"text-blue-600 animate-pulse mb-3\">\r\n");
      out.write("            Memuat daftar file dari FTP...\r\n");
      out.write("        </div>\r\n");
      out.write("\r\n");
      out.write("        <div class=\"flex justify-center\">\r\n");
      out.write("            <select id=\"list_sukses\" size=\"10\"\r\n");
      out.write("                class=\"border border-gray-300 rounded w-full p-2 block\r\n");
      out.write("                    overflow-x-auto overflow-y-auto whitespace-nowrap\"\r\n");
      out.write("                multiple></select>\r\n");
      out.write("        </div>\r\n");
      out.write("\r\n");
      out.write("        <div class=\"flex justify-center mt-4\">\r\n");
      out.write("            <button id=\"btnPrint_sukses\" type=\"button\"\r\n");
      out.write("                class=\"max-w-[160px] w-full  bg-green-600 hover:bg-green-700 text-white font-semibold px-4 py-2 rounded shadow flex items-center justify-center gap-2 transition duration-150 ease-in-out\">\r\n");
      out.write("                <i class=\"fa fa-print\"></i> <span>Chek TXT</span>\r\n");
      out.write("            </button>\r\n");
      out.write("        </div>\r\n");
      out.write("    </fieldset>\r\n");
      out.write("\r\n");
      out.write("    <!-- KANAN - GAGAL -->\r\n");
      out.write("    <fieldset class=\"border border-gray-300 rounded p-5 text-center bg-white shadow w-full\">\r\n");
      out.write("        <h3 class=\"text-xl font-semibold mb-4\">üìÇ Daftar/Gagal File TXT dari AP2T</h3>\r\n");
      out.write("\r\n");
      out.write("        <div id=\"loading_gagal\" class=\"text-blue-600 animate-pulse mb-3\">\r\n");
      out.write("            Memuat daftar file dari FTP...\r\n");
      out.write("        </div>\r\n");
      out.write("\r\n");
      out.write("        <div class=\"flex justify-center\">\r\n");
      out.write("           <select id=\"list_gagal\" size=\"10\"\r\n");
      out.write("                class=\"border border-gray-300 rounded w-full p-2 block\r\n");
      out.write("                    overflow-x-auto overflow-y-auto whitespace-nowrap\"\r\n");
      out.write("                multiple></select>\r\n");
      out.write("        </div>\r\n");
      out.write("\r\n");
      out.write("        <div class=\"flex justify-center mt-4\">\r\n");
      out.write("            <button id=\"btnPrint_gagal\" type=\"button\"\r\n");
      out.write("                class=\"max-w-[160px] w-full  bg-green-600 hover:bg-green-700 text-white font-semibold px-4 py-2 rounded shadow flex items-center justify-center gap-2 transition duration-150 ease-in-out\">\r\n");
      out.write("                <i class=\"fa fa-print\"></i> <span>Chek TXT</span>\r\n");
      out.write("            </button>\r\n");
      out.write("        </div>\r\n");
      out.write("    </fieldset>\r\n");
      out.write("\r\n");
      out.write("</div>\r\n");
      out.write("\r\n");
      out.write("<script>\r\n");
      out.write("document.addEventListener(\"DOMContentLoaded\", function() {\r\n");
      out.write("\r\n");
      out.write("    // ============================================================\r\n");
      out.write("    //  0) FUNGSI GET CONTEXT PATH (UNTUK PEMANGGILAN URL SERVLET)\r\n");
      out.write("    // ============================================================\r\n");
      out.write("    function getContextPath() {\r\n");
      out.write("        return '");
      out.print( request.getContextPath() );
      out.write("';\r\n");
      out.write("    }\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("    // ============================================================\r\n");
      out.write("    //  1) PROSES LOAD FILE TXT DARI FTP SERVER\r\n");
      out.write("    // ============================================================\r\n");
      out.write("    // 1.a Load file TXT dari ap2t\r\n");
      out.write("    async function loadFtpFilesTxt() {\r\n");
      out.write("        const loading_sukses = document.getElementById('loading_sukses');\r\n");
      out.write("        const list_sukses = document.getElementById('list_sukses');\r\n");
      out.write("        const list_gagal = document.getElementById('list_gagal');\r\n");
      out.write("\r\n");
      out.write("        try {\r\n");
      out.write("            // 1.1 Ambil THBL, BANK, dan IDTRANS\r\n");
      out.write("            const raw = document.getElementById(\"bln_usulan\").value;\r\n");
      out.write("            const thblalp = convertBulanTahunToYYYYMM(raw);\r\n");
      out.write("            const bank_miv = document.getElementById(\"bank_miv\").value;\r\n");
      out.write("            const idtrans = document.getElementById('idtrans').value.trim();\r\n");
      out.write("\r\n");
      out.write("            // 1.2 Tampilkan Loading\r\n");
      out.write("            loading_sukses.style.display = 'block';\r\n");
      out.write("            loading_sukses.textContent = \"Memuat daftar file dari FTP...\";\r\n");
      out.write("\r\n");
      out.write("            // 1.3 Kosongkan list sebelum ditampilkan ulang\r\n");
      out.write("            list_sukses.innerHTML = '';\r\n");
      out.write("            list_gagal.innerHTML = '';\r\n");
      out.write("\r\n");
      out.write("            // 1.4 Ambil data file dari server\r\n");
      out.write("            const url = getContextPath()\r\n");
      out.write("                + \"/mon3ChekfileTxt?act=listtxt\"\r\n");
      out.write("                + \"&thbl=\" + thblalp\r\n");
      out.write("                + \"&bankmiv=\" + bank_miv;\r\n");
      out.write("\r\n");
      out.write("            const res = await fetch(url);\r\n");
      out.write("            if (!res.ok) throw new Error(\"Gagal memuat data dari server\");\r\n");
      out.write("\r\n");
      out.write("            let files = await res.json();\r\n");
      out.write("\r\n");
      out.write("            // 1.5 Hilangkan loading\r\n");
      out.write("            loading_sukses.style.display = 'none';\r\n");
      out.write("            loading_gagal.style.display = \"none\";\r\n");
      out.write("\r\n");
      out.write("            // 1.6 Jika tidak ada file\r\n");
      out.write("            if (!files || files.length === 0) {\r\n");
      out.write("                const opt = document.createElement('option');\r\n");
      out.write("                opt.textContent = \"Tidak ada file di folder FTP.\";\r\n");
      out.write("                list_sukses.appendChild(opt);\r\n");
      out.write("                return;\r\n");
      out.write("            }\r\n");
      out.write("\r\n");
      out.write("            // 1.7 Filter berdasarkan IDTRANS\r\n");
      out.write("            let filteredFiles = [];\r\n");
      out.write("\r\n");
      out.write("            if (idtrans === \"\" || idtrans === null || idtrans === \"*\") {\r\n");
      out.write("                filteredFiles = files; // tampilkan semua\r\n");
      out.write("            } else {\r\n");
      out.write("                const pola = idtrans.toLowerCase();\r\n");
      out.write("                filteredFiles = files.filter(f =>\r\n");
      out.write("                    f.toLowerCase().includes(pola)\r\n");
      out.write("                );\r\n");
      out.write("            }\r\n");
      out.write("\r\n");
      out.write("            // 1.8 Jika hasil filter kosong\r\n");
      out.write("            if (filteredFiles.length === 0) {\r\n");
      out.write("                const opt = document.createElement('option');\r\n");
      out.write("                opt.textContent = \"Tidak ada file sesuai ID Transaksi.\";\r\n");
      out.write("                list_sukses.appendChild(opt);\r\n");
      out.write("                return;\r\n");
      out.write("            }\r\n");
      out.write("\r\n");
      out.write("            // 1.9 Tampilkan file ke list (sukses / gagal)\r\n");
      out.write("            filteredFiles.forEach(filePath => {\r\n");
      out.write("                const cleanPath = filePath.replace(/\\/+/g, \"/\");\r\n");
      out.write("                const opt = document.createElement('option');\r\n");
      out.write("\r\n");
      out.write("                opt.value = cleanPath;\r\n");
      out.write("                opt.textContent = cleanPath;\r\n");
      out.write("\r\n");
      out.write("                if (cleanPath.includes(\"/gagal/\")) {\r\n");
      out.write("                    list_gagal.appendChild(opt);\r\n");
      out.write("                } else {\r\n");
      out.write("                    list_sukses.appendChild(opt);\r\n");
      out.write("                }\r\n");
      out.write("            });\r\n");
      out.write("\r\n");
      out.write("        } catch (err) {\r\n");
      out.write("            loading_sukses.innerHTML =\r\n");
      out.write("                '<span class=\"text-red-600\">Terjadi kesalahan: ' + err.message + '</span>';\r\n");
      out.write("        }\r\n");
      out.write("    }\r\n");
      out.write("\r\n");
      out.write("    // 1.b Load file RCN dari bank\r\n");
      out.write("    async function loadFtpFilesRcn() {\r\n");
      out.write("        const loading_sukses = document.getElementById('loading_sukses');\r\n");
      out.write("        const list_sukses = document.getElementById('list_sukses');\r\n");
      out.write("        const list_gagal = document.getElementById('list_gagal');\r\n");
      out.write("\r\n");
      out.write("        try {\r\n");
      out.write("            // 1.1 Ambil THBL, BANK, dan IDTRANS\r\n");
      out.write("            const raw = document.getElementById(\"bln_usulan\").value;\r\n");
      out.write("            const thblalp = convertBulanTahunToYYYYMM(raw);\r\n");
      out.write("            const bank_miv = document.getElementById(\"bank_miv\").value;\r\n");
      out.write("            const idtrans = document.getElementById('idtrans').value.trim();\r\n");
      out.write("\r\n");
      out.write("            // 1.2 Tampilkan Loading\r\n");
      out.write("            loading_sukses.style.display = 'block';\r\n");
      out.write("            loading_sukses.textContent = \"Memuat daftar file dari FTP...\";\r\n");
      out.write("\r\n");
      out.write("            // 1.3 Kosongkan list sebelum ditampilkan ulang\r\n");
      out.write("            list_sukses.innerHTML = '';\r\n");
      out.write("            list_gagal.innerHTML = '';\r\n");
      out.write("\r\n");
      out.write("            // 1.4 Ambil data file dari server\r\n");
      out.write("            const url = getContextPath()\r\n");
      out.write("                + \"/mon3ChekfileTxt?act=listrcn\"\r\n");
      out.write("                + \"&thbl=\" + thblalp\r\n");
      out.write("                + \"&bankmiv=\" + bank_miv;\r\n");
      out.write("\r\n");
      out.write("            const res = await fetch(url);\r\n");
      out.write("            if (!res.ok) throw new Error(\"Gagal memuat data dari server\");\r\n");
      out.write("\r\n");
      out.write("            let files = await res.json();\r\n");
      out.write("\r\n");
      out.write("            // 1.5 Hilangkan loading\r\n");
      out.write("            loading_sukses.style.display = 'none';\r\n");
      out.write("            loading_gagal.style.display = \"none\";\r\n");
      out.write("\r\n");
      out.write("            // 1.6 Jika tidak ada file\r\n");
      out.write("            if (!files || files.length === 0) {\r\n");
      out.write("                const opt = document.createElement('option');\r\n");
      out.write("                opt.textContent = \"Tidak ada file di folder FTP.\";\r\n");
      out.write("                list_sukses.appendChild(opt);\r\n");
      out.write("                return;\r\n");
      out.write("            }\r\n");
      out.write("\r\n");
      out.write("            // 1.7 Filter berdasarkan IDTRANS\r\n");
      out.write("            let filteredFiles = [];\r\n");
      out.write("\r\n");
      out.write("            if (idtrans === \"\" || idtrans === null || idtrans === \"*\") {\r\n");
      out.write("                filteredFiles = files; // tampilkan semua\r\n");
      out.write("            } else {\r\n");
      out.write("                const pola = idtrans.toLowerCase();\r\n");
      out.write("                filteredFiles = files.filter(f =>\r\n");
      out.write("                    f.toLowerCase().includes(pola)\r\n");
      out.write("                );\r\n");
      out.write("            }\r\n");
      out.write("\r\n");
      out.write("            // 1.8 Jika hasil filter kosong\r\n");
      out.write("            if (filteredFiles.length === 0) {\r\n");
      out.write("                const opt = document.createElement('option');\r\n");
      out.write("                opt.textContent = \"Tidak ada file sesuai ID Transaksi.\";\r\n");
      out.write("                list_sukses.appendChild(opt);\r\n");
      out.write("                return;\r\n");
      out.write("            }\r\n");
      out.write("\r\n");
      out.write("            // 1.9 Tampilkan file ke list (sukses / gagal)\r\n");
      out.write("            filteredFiles.forEach(filePath => {\r\n");
      out.write("                const cleanPath = filePath.replace(/\\/+/g, \"/\");\r\n");
      out.write("                const opt = document.createElement('option');\r\n");
      out.write("\r\n");
      out.write("                opt.value = cleanPath;\r\n");
      out.write("                opt.textContent = cleanPath;\r\n");
      out.write("\r\n");
      out.write("                if (cleanPath.includes(\"/gagal/\")) {\r\n");
      out.write("                    list_gagal.appendChild(opt);\r\n");
      out.write("                } else {\r\n");
      out.write("                    list_sukses.appendChild(opt);\r\n");
      out.write("                }\r\n");
      out.write("            });\r\n");
      out.write("\r\n");
      out.write("        } catch (err) {\r\n");
      out.write("            loading_sukses.innerHTML =\r\n");
      out.write("                '<span class=\"text-red-600\">Terjadi kesalahan: ' + err.message + '</span>';\r\n");
      out.write("        }\r\n");
      out.write("    }\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("    // ============================================================\r\n");
      out.write("    //  2) KONVERSI BULAN \"November 2025\" ‚Üí \"202511\"\r\n");
      out.write("    // ============================================================\r\n");
      out.write("    function convertBulanTahunToYYYYMM(input) {\r\n");
      out.write("        const bulanMap = {\r\n");
      out.write("            \"Januari\": \"01\", \"Februari\": \"02\", \"Maret\": \"03\",\r\n");
      out.write("            \"April\": \"04\", \"Mei\": \"05\", \"Juni\": \"06\",\r\n");
      out.write("            \"Juli\": \"07\", \"Agustus\": \"08\", \"September\": \"09\",\r\n");
      out.write("            \"Oktober\": \"10\", \"November\": \"11\", \"Desember\": \"12\"\r\n");
      out.write("        };\r\n");
      out.write("\r\n");
      out.write("        const parts = input.split(\" \");  \r\n");
      out.write("        return parts[1] + bulanMap[parts[0]];\r\n");
      out.write("    }\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("    // ============================================================\r\n");
      out.write("    //  3) INIT FLATPICKR UNTUK PILIH BULAN\r\n");
      out.write("    // ============================================================\r\n");
      out.write("    if (typeof flatpickr !== \"undefined\") {\r\n");
      out.write("        const blnUsulan = document.getElementById('bln_usulan');\r\n");
      out.write("        const blnUsulanValue = document.getElementById('bln_usulan_value');\r\n");
      out.write("        const calendarIcon = document.getElementById('calendarIcon');\r\n");
      out.write("\r\n");
      out.write("        const fp = flatpickr(blnUsulan, {\r\n");
      out.write("            locale: \"id\",\r\n");
      out.write("            plugins: [new monthSelectPlugin({\r\n");
      out.write("                shorthand: false,\r\n");
      out.write("                dateFormat: \"F Y\",\r\n");
      out.write("                altFormat: \"Y-m\"\r\n");
      out.write("            })],\r\n");
      out.write("            defaultDate: new Date(),\r\n");
      out.write("\r\n");
      out.write("            // 3.1 Update value YYYYMM\r\n");
      out.write("            onChange: function(selectedDates) {\r\n");
      out.write("                const date = selectedDates[0];\r\n");
      out.write("                if (date) {\r\n");
      out.write("                    const yyyy = date.getFullYear();\r\n");
      out.write("                    const mm = String(date.getMonth() + 1).padStart(2, '0');\r\n");
      out.write("                    blnUsulanValue.value = yyyy + mm;\r\n");
      out.write("                }\r\n");
      out.write("            },\r\n");
      out.write("\r\n");
      out.write("            // 3.2 Set default value saat halaman pertama dibuka\r\n");
      out.write("            onReady: function(selectedDates) {\r\n");
      out.write("                const date = selectedDates[0] || new Date();\r\n");
      out.write("                const yyyy = date.getFullYear();\r\n");
      out.write("                const mm = String(date.getMonth() + 1).padStart(2, '0');\r\n");
      out.write("                blnUsulanValue.value = yyyy + mm;\r\n");
      out.write("                blnUsulan.value = date.toLocaleString('id-ID', { month: 'long' }) + ' ' + yyyy;\r\n");
      out.write("            }\r\n");
      out.write("        });\r\n");
      out.write("\r\n");
      out.write("        // Klik icon = buka calendar\r\n");
      out.write("        calendarIcon.addEventListener('click', function() {\r\n");
      out.write("            fp.open();\r\n");
      out.write("        });\r\n");
      out.write("    }\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("    // ============================================================\r\n");
      out.write("    //  4) LOAD DAFTAR BANK MIV DARI SERVER\r\n");
      out.write("    // ============================================================\r\n");
      out.write("    async function loadBankMIV() {\r\n");
      out.write("        const params = new URLSearchParams();\r\n");
      out.write("        params.append('act', 'getNamaBank');\r\n");
      out.write("        params.append('kdbank', '');\r\n");
      out.write("\r\n");
      out.write("        try {\r\n");
      out.write("            const res = await fetch(getContextPath() + '/mst-global', {\r\n");
      out.write("                method: 'POST',\r\n");
      out.write("                headers: { 'Content-Type': 'application/x-www-form-urlencoded' },\r\n");
      out.write("                body: params.toString()\r\n");
      out.write("            });\r\n");
      out.write("\r\n");
      out.write("            if (!res.ok) throw new Error(\"HTTP Error \" + res.status);\r\n");
      out.write("\r\n");
      out.write("            const json = await res.json();\r\n");
      out.write("            const select = document.getElementById('bank_miv');\r\n");
      out.write("\r\n");
      out.write("            select.innerHTML = '<option value=\"\">-- Pilih Bank MIV --</option>';\r\n");
      out.write("\r\n");
      out.write("            if (json.status === 'success' && Array.isArray(json.data)) {\r\n");
      out.write("                json.data.forEach(bank => {\r\n");
      out.write("                    const opt = document.createElement('option');\r\n");
      out.write("                    opt.value = bank.KODE_ERP;\r\n");
      out.write("                    opt.textContent = bank.NAMA_BANK;\r\n");
      out.write("                    select.appendChild(opt);\r\n");
      out.write("                });\r\n");
      out.write("            } else {\r\n");
      out.write("                const opt = document.createElement('option');\r\n");
      out.write("                opt.textContent = \"Tidak ada data bank\";\r\n");
      out.write("                select.appendChild(opt);\r\n");
      out.write("            }\r\n");
      out.write("        } catch (err) {\r\n");
      out.write("            console.error(\"‚ùå Error:\", err.message);\r\n");
      out.write("        }\r\n");
      out.write("    }\r\n");
      out.write("\r\n");
      out.write("    // 4.1 Jalankan otomatis\r\n");
      out.write("    loadBankMIV();\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("    // ============================================================\r\n");
      out.write("    //  5) CLEAR LIST FILE (SUKSES & GAGAL)\r\n");
      out.write("    // ============================================================\r\n");
      out.write("    function clearList() {\r\n");
      out.write("        document.getElementById(\"list_sukses\").innerHTML = \"\";\r\n");
      out.write("        document.getElementById(\"list_gagal\").innerHTML = \"\";\r\n");
      out.write("    }\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("    // ============================================================\r\n");
      out.write("    //  6) TOMBOL TAMPILKAN (LOAD TXT / RCN)\r\n");
      out.write("    // ============================================================\r\n");
      out.write("    document.getElementById('btnTampil').addEventListener('click', function () {\r\n");
      out.write("        const bank_miv = document.getElementById(\"bank_miv\").value;\r\n");
      out.write("        const jenis    = document.getElementById(\"idtxt_rcn\").value;\r\n");
      out.write("\r\n");
      out.write("        if (!bank_miv) {\r\n");
      out.write("            alert(\"‚ö† Silakan pilih BANK MIV terlebih dahulu!\");\r\n");
      out.write("            return;\r\n");
      out.write("        }\r\n");
      out.write("        if (jenis === \"\") {\r\n");
      out.write("            alert(\"‚ö† Silakan pilih jenis file (TXT/RCN)!\");\r\n");
      out.write("            return;\r\n");
      out.write("        }\r\n");
      out.write("\r\n");
      out.write("        clearList();\r\n");
      out.write("\r\n");
      out.write("        if (jenis === \"TXT\") {\r\n");
      out.write("            loadFtpFilesTxt();\r\n");
      out.write("        } else if (jenis === \"RCN\") {\r\n");
      out.write("            loadFtpFilesRcn();\r\n");
      out.write("        }\r\n");
      out.write("    });\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("    // ============================================================\r\n");
      out.write("    //  7) DOWNLOAD FILE TXT (SUKSES / GAGAL)\r\n");
      out.write("    // ============================================================\r\n");
      out.write("    function downloadTxtFile(path) {\r\n");
      out.write("        if (!path) {\r\n");
      out.write("            alert(\"‚ö† Pilih file dulu!\");\r\n");
      out.write("            return;\r\n");
      out.write("        }\r\n");
      out.write("\r\n");
      out.write("        const url = getContextPath()\r\n");
      out.write("                + \"/mon3ChekfileTxt?act=download&file=\"\r\n");
      out.write("                + encodeURIComponent(path);\r\n");
      out.write("\r\n");
      out.write("        const a = document.createElement('a');\r\n");
      out.write("        a.href = url;\r\n");
      out.write("        a.target = \"_blank\";\r\n");
      out.write("        a.download = \"\";\r\n");
      out.write("        document.body.appendChild(a);\r\n");
      out.write("        a.click();\r\n");
      out.write("        a.remove();\r\n");
      out.write("    }\r\n");
      out.write("\r\n");
      out.write("    // 7.1 Download file sukses\r\n");
      out.write("    document.getElementById('btnPrint_sukses').addEventListener('click', function() {\r\n");
      out.write("        const selected = document.getElementById('list_sukses').value;\r\n");
      out.write("        if (selected) downloadTxtFile(selected);\r\n");
      out.write("    });\r\n");
      out.write("\r\n");
      out.write("    document.getElementById('list_sukses').addEventListener('dblclick', function(e) {\r\n");
      out.write("        if (e.target.value) downloadTxtFile(e.target.value);\r\n");
      out.write("    });\r\n");
      out.write("\r\n");
      out.write("    document.getElementById('list_sukses').addEventListener('keydown', function(e) {\r\n");
      out.write("        if (e.key === \"Enter\") {\r\n");
      out.write("            const selected = this.value;\r\n");
      out.write("            if (selected) downloadTxtFile(selected);\r\n");
      out.write("        }\r\n");
      out.write("    });\r\n");
      out.write("\r\n");
      out.write("    // 7.2 Download file gagal\r\n");
      out.write("    document.getElementById('btnPrint_gagal').addEventListener('click', function() {\r\n");
      out.write("        const selected = document.getElementById('list_gagal').value;\r\n");
      out.write("        if (selected) downloadTxtFile(selected);\r\n");
      out.write("    });\r\n");
      out.write("\r\n");
      out.write("    document.getElementById('list_gagal').addEventListener('dblclick', function(e) {\r\n");
      out.write("        if (e.target.value) downloadTxtFile(e.target.value);\r\n");
      out.write("    });\r\n");
      out.write("\r\n");
      out.write("    document.getElementById('list_gagal').addEventListener('keydown', function(e) {\r\n");
      out.write("        if (e.key === \"Enter\") {\r\n");
      out.write("            const selected = this.value;\r\n");
      out.write("            if (selected) downloadTxtFile(selected);\r\n");
      out.write("        }\r\n");
      out.write("    });\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("    // ============================================================\r\n");
      out.write("    //  8) UPDATE LABEL JUDUL SAAT COMBO TXT/RCN DIPILIH\r\n");
      out.write("    // ============================================================\r\n");
      out.write("    document.getElementById(\"idtxt_rcn\").addEventListener(\"change\", function () {\r\n");
      out.write("        const jenis = this.value;\r\n");
      out.write("        const labelSukses = document.getElementById(\"label_sukses\");\r\n");
      out.write("\r\n");
      out.write("        if (jenis === \"TXT\") {\r\n");
      out.write("            labelSukses.textContent = \"üìÇ Daftar File TXT dari AP2T\";\r\n");
      out.write("        } else if (jenis === \"RCN\") {\r\n");
      out.write("            labelSukses.textContent = \"üìÇ Daftar/Lunas File RCN dari BANK\";\r\n");
      out.write("        }\r\n");
      out.write("    });\r\n");
      out.write("\r\n");
      out.write("});\r\n");
      out.write("</script>\r\n");
      out.write("\r\n");
      out.write("\r\n");
    } catch (java.lang.Throwable t) {
      if (!(t instanceof javax.servlet.jsp.SkipPageException)){
        out = _jspx_out;
        if (out != null && out.getBufferSize() != 0)
          try { out.clearBuffer(); } catch (java.io.IOException e) {}
        if (_jspx_page_context != null) _jspx_page_context.handlePageException(t);
        else throw new ServletException(t);
      }
    } finally {
      _jspxFactory.releasePageContext(_jspx_page_context);
    }
  }
}
